/* Copyright (c) 2012 Jeremiah Goyette */
(function(a){function b(a,b){var c=Math.round(a*Math.pow(10,b))/Math.pow(10,b);return c}"use strict";var c=a.setGraph=function(a){function n(a){while(a>=c.m)a-=c.m;while(a<0)a+=c.m;return b(a,2)}function o(a){var b=Math.cos(a/c.m*2*Math.PI),d=Math.sin(a/c.m*2*Math.PI);return{x:g*d+g+h,y:-1*g*b+g+h}}function p(a){var b,c=-1;for(b=e.length-1;b>=0;b--)e[b].pc==a&&c++;return c<1&&(c=0),(1+c*l)*k}function q(){for(var a=e.length-1;a>=0;a--){if(!e[a].fixed){var b=o(e[a].pc);e[a].dot.attr({cx:b.x,cy:b.y})}e[a].dot.attr({r:p(e[a].pc)})}}var c={},d,e=[],f=!1,g=180,h=30,i=2*(g+h),j=5,k=8,l=.5,m=function(){return!1};c.m=12;var r=function(a,b){this.pc=a||0,this.fixed=b||!1;var c=o(a);this.dot=d.circle(c.x,c.y,p(a)),this.dot.attr({fill:"black"}),this.dot.click(m)};return c.configure=function(a){g=a.radius||g,h=a.padding||h,i=2*(g+h),j=a.ticksize||j,k=a.dotsize||k,l=a.dotsizeinc||l,m=a.dotclick&&typeof a.dotclick=="function"?a.dotclick:m},c.plotpcs=function(b,f){d&&(c.clear(d),e=[]),d=new Raphael(document.getElementById(a),i,i);var k=d.circle(g+h,g+h,g);k.attr({"stroke-width":4});for(var l=0;l<c.m;l++){var m=o(l),n=d.circle(m.x,m.y,j);n.attr({fill:"white"})}if(b)for(var l=b.length-1;l>=0;l--){f=f||0;var p=l>=f?!1:!0,s=new r(b[l],p);e.unshift(s)}q()},c.getpcs=function(){var a=[];for(var b=e.length-1;b>=0;b--)a.unshift(e[b].pc);return a},c.transpose=function(a,b){for(var c=e.length-1;c>=0;c--)e[c].fixed||(e[c].pc=n(e[c].pc+a));q(),b&&typeof b=="function"&&b()},c.animTranspose=function(a,b){function i(){var c=a*d/g;for(var j=e.length-1;j>=0;j--)e[j].fixed||(e[j].pc=n(h[j]+c));q(),b&&typeof b=="function"&&b(),d<g?setTimeout(function(){i()},10):f=!1,d++}if(f)return;f=!0;var d=0,g=40,h=c.getpcs();i()},c.invert=function(a,b){for(var c=e.length-1;c>=0;c--)e[c].fixed||(e[c].pc=n(a-e[c].pc));q(),b&&typeof b=="function"&&b()},c.animInvert=function(a,b){function i(){var j=d/g;for(var k=e.length-1;k>=0;k--){if(!e[k].fixed){var l=n(a-2*h[k]);l>c.m/2&&(l-=c.m),e[k].pc=n(h[k]+j*l);var m=o(e[k].pc);e[k].dot.attr({cx:m.x,cy:m.y})}e[k].dot.attr({r:p(e[k].pc)})}b&&typeof b=="function"&&b(),d<g?setTimeout(function(){i()},10):f=!1,d++}if(f)return;f=!0;var d=0,g=40,h=c.getpcs();i()},c.animInvertDirect=function(a,b){function q(){var i=c/d;for(var j=e.length-1;j>=0;j--)if(!e[j].fixed){var k=g[j].x+i*(h[j].x-g[j].x),l=g[j].y+i*(h[j].y-g[j].y);e[j].dot.attr({cx:k,cy:l})}if(c<d)setTimeout(function(){q()},10);else{for(var j=e.length-1;j>=0;j--)e[j].fixed||(e[j].pc=n(a-e[j].pc));for(var j=e.length-1;j>=0;j--)e[j].dot.attr({r:p(e[j].pc)});b&&typeof b=="function"&&b(),f=!1}c++}if(f)return;f=!0;var c=0,d=40,g=[],h=[];for(var i=e.length-1;i>=0;i--){var j=0;e[i].fixed?(g.unshift(0),h.unshift(0)):(g.unshift(o(e[i].pc)),h.unshift(o(n(a-e[i].pc))));for(var m=e.length-1;m>=0;m--)i!=m&&e[i].pc==e[m].pc&&e[i].fixed==e[m].fixed&&j++;e[i].dot.attr({r:(1+j*l)*k})}q()},c.clear=function(){if(!d)return;var a=d.canvas;a.parentNode.removeChild(a)},c}})(window)