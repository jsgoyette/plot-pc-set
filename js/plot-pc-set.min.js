/* Copyright (c) 2012 Jeremiah Goyette */
(function(a){function b(a,b){var c=Math.round(a*Math.pow(10,b))/Math.pow(10,b);return c}"use strict";var c=a.setGraph=function(a){function o(a){while(a>=g)a-=g;while(a<0)a+=g;return b(a,2)}function p(a){var b=Math.cos(a/g*2*Math.PI),c=Math.sin(a/g*2*Math.PI);return{x:h*c+h+i,y:-1*h*b+h+i}}function q(a){var b,c=0;for(b=f.length-1;b>=0;b--)f[b].pc==a&&c++;return Math.sqrt(c)*l}function r(){for(var a=f.length-1;a>=0;a--){if(!f[a].fixed){var b=p(f[a].pc);f[a].dot.attr({cx:b.x,cy:b.y})}f[a].dot.attr({r:q(f[a].pc)})}}var c={},d,e=!1,f=[],g=12,h=180,i=30,j=2*(h+i),k=5,l=8,m=50,n=function(){return!1},s=function(a,b){this.pc=a||0,this.fixed=b||!1;var c=p(a);this.dot=d.circle(c.x,c.y,q(a)),this.dot.attr({fill:"black"}),this.dot.click(n)};return c.configure=function(a){g=a.mod||g,h=a.radius||h,i=a.padding||i,j=2*(h+i),k=a.ticksize||k,l=a.dotsize||l,n=a.dotclick&&typeof a.dotclick=="function"?a.dotclick:n},c.plotpcs=function(b,e){d&&(c.clear(d),f=[]),b=b||[],e=e||0,d=new Raphael(document.getElementById(a),j,j);var l=d.circle(h+i,h+i,h);l.attr({"stroke-width":4});for(var m=0;m<g;m++){var n=p(m),o=d.circle(n.x,n.y,k);o.attr({fill:"white"})}for(var m=b.length-1;m>=0;m--){var q=m>=e?!1:!0,t=new s(b[m],q);f.unshift(t)}r()},c.getpcs=function(){var a=[];for(var b=f.length-1;b>=0;b--)a.unshift(f[b].pc);return a},c.transpose=function(a,b){for(var c=f.length-1;c>=0;c--)f[c].fixed||(f[c].pc=o(f[c].pc+a));r(),b&&typeof b=="function"&&b()},c.animTranspose=function(a,b){function h(){var c=a*d/m;for(var i=f.length-1;i>=0;i--)f[i].fixed||(f[i].pc=o(g[i]+c));r(),b&&typeof b=="function"&&b(),d<m?setTimeout(function(){h()},10):e=!1,d++}if(e)return;e=!0;var d=0,g=c.getpcs();h()},c.invert=function(a,b){for(var c=f.length-1;c>=0;c--)f[c].fixed||(f[c].pc=o(a-f[c].pc));r(),b&&typeof b=="function"&&b()},c.animInvert=function(a,b){function i(){var c=d/m;for(var j=f.length-1;j>=0;j--){if(!f[j].fixed){var k=o(a-2*h[j]);k>g/2&&(k-=g),f[j].pc=o(h[j]+c*k);var l=p(f[j].pc);f[j].dot.attr({cx:l.x,cy:l.y})}f[j].dot.attr({r:q(f[j].pc)})}b&&typeof b=="function"&&b(),d<m?setTimeout(function(){i()},10):e=!1,d++}if(e)return;e=!0;var d=0,h=c.getpcs();i()},c.animInvertDirect=function(a,b){function k(){var h=c/m;for(var i=f.length-1;i>=0;i--)if(!f[i].fixed){var j=d[i].x+h*(g[i].x-d[i].x),l=d[i].y+h*(g[i].y-d[i].y);f[i].dot.attr({cx:j,cy:l})}if(c<m)setTimeout(function(){k()},10);else{for(var i=f.length-1;i>=0;i--)f[i].fixed||(f[i].pc=o(a-f[i].pc));for(var i=f.length-1;i>=0;i--)f[i].dot.attr({r:q(f[i].pc)});b&&typeof b=="function"&&b(),e=!1}c++}if(e)return;e=!0;var c=0,d=[],g=[];for(var h=f.length-1;h>=0;h--){var i=0;f[h].fixed?(d.unshift(0),g.unshift(0)):(d.unshift(p(f[h].pc)),g.unshift(p(o(a-f[h].pc))));for(var j=f.length-1;j>=0;j--)f[h].pc==f[j].pc&&f[h].fixed==f[j].fixed&&i++;f[h].dot.attr({r:Math.sqrt(i)*l})}k()},c.clear=function(){if(!d)return;var a=d.canvas;a.parentNode.removeChild(a)},c}})(window)