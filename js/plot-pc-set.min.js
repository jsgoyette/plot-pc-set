/*
 * plot-pc-set.js ~ Copyright (c) 2012 Jeremiah Goyette
 */
(function(a,b){function c(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)}"use strict";var d=b.setGraph=function(d){function r(a){while(a>=i)a-=i;while(a<0)a+=i;return c(a,2)}function s(a){var b=Math.cos(a/i*2*Math.PI),c=Math.sin(a/i*2*Math.PI);return{x:Math.floor(j*c+j+k),y:Math.floor(-1*j*b+j+k)}}function t(){var a,b,c,d=new Array(h.length);for(a=h.length-1;a>=0;a--){c=0;for(b=h.length-1;b>=0;b--){if(b>a&&h[a].pc==h[b].pc){d[a]=d[b];break}h[a].pc==h[b].pc&&c++}d[a]=d[a]||Math.sqrt(c)*n}return d}function u(){var a,b=t();for(a=h.length-1;a>=0;a--){var c=s(h[a].pc);h[a].dot.attr({cx:c.x,cy:c.y}),h[a].dot.attr({r:b[a]})}}var e={},f=null,g=!1,h=[],i=12,j=180,k=30,l=2*(j+k),m=5,n=8,o=50,p=15,q=function(){return!1},v=function(a,b){a=a||0,b=b||!1;var c=s(a),d=f.circle(c.x,c.y,n);return d.attr({fill:"black"}),d.click(q),{pc:a,fixed:b,dot:d}};return e.configure=function(a){i=a.mod||i,j=a.radius||j,k=a.padding||k,l=2*(j+k),m=a.ticksize||m,n=a.dotsize||n,q=a.dotclick&&typeof a.dotclick=="function"?a.dotclick:q},e.plotpcs=function(b,c){f&&(e.clear(f),h=[]),b=b||[],c=c||0,f=new Raphael(a.getElementById(d),l,l);var g,n=f.circle(j+k,j+k,j);n.attr({"stroke-width":4});for(g=0;g<i;g++){var o=s(g),p=f.circle(o.x,o.y,m);p.attr({fill:"white"})}for(g=b.length-1;g>=0;g--){var q=g>=c?!1:!0,r=v(b[g],q);h.unshift(r)}u()},e.getpcs=function(){var a,b=[];for(a=h.length-1;a>=0;a--)b.unshift(h[a].pc);return b},e.transpose=function(a,b){for(var c=h.length-1;c>=0;c--)h[c].fixed||(h[c].pc=r(h[c].pc+a));u(),b&&typeof b=="function"&&b()},e.animTranspose=function(a,c){if(g)return;g=!0;var d,f,i=0,j=e.getpcs();(function k(){f=a*i/o;for(d=h.length-1;d>=0;d--)h[d].fixed||(h[d].pc=r(j[d]+f));u(),c&&typeof c=="function"&&c(),i<o?b.setTimeout(function(){k()},p):g=!1,i++})()},e.invert=function(a,b){for(var c=h.length-1;c>=0;c--)h[c].fixed||(h[c].pc=r(a-h[c].pc));u(),b&&typeof b=="function"&&b()},e.animInvert=function(a,c){if(g)return;g=!0;var d=0,f=e.getpcs();(function j(){var e,k,l,m,n=d/o;for(e=h.length-1;e>=0;e--)h[e].fixed||(m=r(a-2*f[e]),m>i/2&&(m-=i),h[e].pc=r(f[e]+n*m),k=s(h[e].pc),h[e].dot.attr({cx:k.x,cy:k.y}));l=t();for(e=h.length-1;e>=0;e--)h[e].dot.attr({r:l[e]});c&&typeof c=="function"&&c(),d<o?b.setTimeout(function(){j()},p):g=!1,d++})()},e.animInvertDirect=function(a,c){if(g)return;g=!0;var d,e,f,i=0,j=[],k=[];for(d=h.length-1;d>=0;d--){f=0,h[d].fixed?(j.unshift(0),k.unshift(0)):(j.unshift(s(h[d].pc)),k.unshift(s(r(a-h[d].pc))));for(e=h.length-1;e>=0;e--)h[d].pc==h[e].pc&&h[d].fixed==h[e].fixed&&f++;h[d].dot.attr({r:Math.sqrt(f)*n})}(function l(){var d,e,f,m=i/o;for(d=h.length-1;d>=0;d--)h[d].fixed||(e=j[d].x+m*(k[d].x-j[d].x),f=j[d].y+m*(k[d].y-j[d].y),h[d].dot.attr({cx:e,cy:f}));if(i<o)b.setTimeout(function(){l()},p);else{var n;for(d=h.length-1;d>=0;d--)h[d].fixed||(h[d].pc=r(a-h[d].pc));n=t();for(d=h.length-1;d>=0;d--)h[d].dot.attr({r:n[d]});c&&typeof c=="function"&&c(),g=!1}i++})()},e.clear=function(){if(!f)return;var a=f.canvas;a.parentNode.removeChild(a)},e}})(document,window)