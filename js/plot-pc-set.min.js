/* Copyright (c) 2012 Jeremiah Goyette */
(function(a){function b(a,b){var c=Math.round(a*Math.pow(10,b))/Math.pow(10,b);return c}"use strict";var c=a.setGraph=function(a){function n(a){while(a>=g)a-=g;while(a<0)a+=g;return b(a,2)}function o(a){var b=Math.cos(a/g*2*Math.PI),c=Math.sin(a/g*2*Math.PI);return{x:h*c+h+i,y:-1*h*b+h+i}}function p(a){var b,c=0;for(b=f.length-1;b>=0;b--)f[b].pc==a&&c++;return Math.sqrt(c)*l}function q(){for(var a=f.length-1;a>=0;a--){if(!f[a].fixed){var b=o(f[a].pc);f[a].dot.attr({cx:b.x,cy:b.y})}f[a].dot.attr({r:p(f[a].pc)})}}var c={},d,e=!1,f=[],g=12,h=180,i=30,j=2*(h+i),k=5,l=8,m=function(){return!1},r=function(a,b){this.pc=a||0,this.fixed=b||!1;var c=o(a);this.dot=d.circle(c.x,c.y,p(a)),this.dot.attr({fill:"black"}),this.dot.click(m)};return c.configure=function(a){g=a.mod||g,h=a.radius||h,i=a.padding||i,j=2*(h+i),k=a.ticksize||k,l=a.dotsize||l,m=a.dotclick&&typeof a.dotclick=="function"?a.dotclick:m},c.plotpcs=function(b,e){d&&(c.clear(d),f=[]),d=new Raphael(document.getElementById(a),j,j);var l=d.circle(h+i,h+i,h);l.attr({"stroke-width":4});for(var m=0;m<g;m++){var n=o(m),p=d.circle(n.x,n.y,k);p.attr({fill:"white"})}b=b||[];for(var m=b.length-1;m>=0;m--){e=e||0;var s=m>=e?!1:!0,t=new r(b[m],s);f.unshift(t)}q()},c.getpcs=function(){var a=[];for(var b=f.length-1;b>=0;b--)a.unshift(f[b].pc);return a},c.transpose=function(a,b){for(var c=f.length-1;c>=0;c--)f[c].fixed||(f[c].pc=n(f[c].pc+a));q(),b&&typeof b=="function"&&b()},c.animTranspose=function(a,b){function i(){var c=a*d/g;for(var j=f.length-1;j>=0;j--)f[j].fixed||(f[j].pc=n(h[j]+c));q(),b&&typeof b=="function"&&b(),d<g?setTimeout(function(){i()},10):e=!1,d++}if(e)return;e=!0;var d=0,g=40,h=c.getpcs();i()},c.invert=function(a,b){for(var c=f.length-1;c>=0;c--)f[c].fixed||(f[c].pc=n(a-f[c].pc));q(),b&&typeof b=="function"&&b()},c.animInvert=function(a,b){function j(){var c=d/h;for(var k=f.length-1;k>=0;k--){if(!f[k].fixed){var l=n(a-2*i[k]);l>g/2&&(l-=g),f[k].pc=n(i[k]+c*l);var m=o(f[k].pc);f[k].dot.attr({cx:m.x,cy:m.y})}f[k].dot.attr({r:p(f[k].pc)})}b&&typeof b=="function"&&b(),d<h?setTimeout(function(){j()},10):e=!1,d++}if(e)return;e=!0;var d=0,h=40,i=c.getpcs();j()},c.animInvertDirect=function(a,b){function m(){var i=c/d;for(var j=f.length-1;j>=0;j--)if(!f[j].fixed){var k=g[j].x+i*(h[j].x-g[j].x),l=g[j].y+i*(h[j].y-g[j].y);f[j].dot.attr({cx:k,cy:l})}if(c<d)setTimeout(function(){m()},10);else{for(var j=f.length-1;j>=0;j--)f[j].fixed||(f[j].pc=n(a-f[j].pc));for(var j=f.length-1;j>=0;j--)f[j].dot.attr({r:p(f[j].pc)});b&&typeof b=="function"&&b(),e=!1}c++}if(e)return;e=!0;var c=0,d=40,g=[],h=[];for(var i=f.length-1;i>=0;i--){var j=0;f[i].fixed?(g.unshift(0),h.unshift(0)):(g.unshift(o(f[i].pc)),h.unshift(o(n(a-f[i].pc))));for(var k=f.length-1;k>=0;k--)f[i].pc==f[k].pc&&f[i].fixed==f[k].fixed&&j++;f[i].dot.attr({r:Math.sqrt(j)*l})}m()},c.clear=function(){if(!d)return;var a=d.canvas;a.parentNode.removeChild(a)},c}})(window)