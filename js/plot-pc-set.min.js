/*
 * plot-pc-set (c) 2012 Jeremiah Goyette - License MIT
 */
(function(a,b){function c(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)}"use strict";var d=b.setGraph=function(b){function p(a){while(a>=h)a-=h;while(a<0)a+=h;return c(a,2)}function q(a){var b=Math.cos(a/h*2*Math.PI),c=Math.sin(a/h*2*Math.PI);return{x:i*c+i+j,y:-1*i*b+i+j}}function r(){var a,b,c,d=new Array(g.length);for(a=g.length-1;a>=0;a--){c=0;for(b=g.length-1;b>=0;b--){if(b>a&&g[a].pc==g[b].pc){d[a]=d[b];break}g[a].pc==g[b].pc&&c++}d[a]=d[a]||Math.sqrt(c)*m}return d}function s(){var a,b=r();for(a=g.length-1;a>=0;a--){var c=q(g[a].pc);g[a].dot.attr({cx:c.x,cy:c.y}),g[a].dot.attr({r:b[a]})}}var d={},e=null,f=!1,g=[],h=12,i=180,j=30,k=2*(i+j),l=5,m=8,n=50,o=function(){return!1},t=function(a,b){a=a||0,b=b||!1;var c=q(a),d=e.circle(c.x,c.y,m);return d.attr({fill:"black"}),d.click(o),{pc:a,fixed:b,dot:d}};return d.configure=function(a){h=a.mod||h,i=a.radius||i,j=a.padding||j,k=2*(i+j),l=a.ticksize||l,m=a.dotsize||m,o=a.dotclick&&typeof a.dotclick=="function"?a.dotclick:o},d.plotpcs=function(c,f){e&&(d.clear(e),g=[]),c=c||[],f=f||0,e=new Raphael(a.getElementById(b),k,k);var m,n=e.circle(i+j,i+j,i);n.attr({"stroke-width":4});for(m=0;m<h;m++){var o=q(m),p=e.circle(o.x,o.y,l);p.attr({fill:"white"})}for(m=c.length-1;m>=0;m--){var r=m>=f?!1:!0,u=t(c[m],r);g.unshift(u)}s()},d.getpcs=function(){var a,b=[];for(a=g.length-1;a>=0;a--)b.unshift(g[a].pc);return b},d.transpose=function(a,b){for(var c=g.length-1;c>=0;c--)g[c].fixed||(g[c].pc=p(g[c].pc+a));s(),b&&typeof b=="function"&&b()},d.animTranspose=function(a,b){function j(){e=a*h/n;for(c=g.length-1;c>=0;c--)g[c].fixed||(g[c].pc=p(i[c]+e));s(),b&&typeof b=="function"&&b(),h<n?setTimeout(function(){j()},10):f=!1,h++}if(f)return;f=!0;var c,e,h=0,i=d.getpcs();j()},d.invert=function(a,b){for(var c=g.length-1;c>=0;c--)g[c].fixed||(g[c].pc=p(a-g[c].pc));s(),b&&typeof b=="function"&&b()},d.animInvert=function(a,b){function i(){var d,j,k,l,m=c/n;for(d=g.length-1;d>=0;d--)g[d].fixed||(l=p(a-2*e[d]),l>h/2&&(l-=h),g[d].pc=p(e[d]+m*l),j=q(g[d].pc),g[d].dot.attr({cx:j.x,cy:j.y}));k=r();for(d=g.length-1;d>=0;d--)g[d].dot.attr({r:k[d]});b&&typeof b=="function"&&b(),c<n?setTimeout(function(){i()},10):f=!1,c++}if(f)return;f=!0;var c=0,e=d.getpcs();i()},d.animInvertDirect=function(a,b){function k(){var c,d,e,l=h/n;for(c=g.length-1;c>=0;c--)g[c].fixed||(d=i[c].x+l*(j[c].x-i[c].x),e=i[c].y+l*(j[c].y-i[c].y),g[c].dot.attr({cx:d,cy:e}));if(h<n)setTimeout(function(){k()},10);else{var m;for(c=g.length-1;c>=0;c--)g[c].fixed||(g[c].pc=p(a-g[c].pc));m=r();for(c=g.length-1;c>=0;c--)g[c].dot.attr({r:m[c]});b&&typeof b=="function"&&b(),f=!1}h++}if(f)return;f=!0;var c,d,e,h=0,i=[],j=[];for(c=g.length-1;c>=0;c--){e=0,g[c].fixed?(i.unshift(0),j.unshift(0)):(i.unshift(q(g[c].pc)),j.unshift(q(p(a-g[c].pc))));for(d=g.length-1;d>=0;d--)g[c].pc==g[d].pc&&g[c].fixed==g[d].fixed&&e++;g[c].dot.attr({r:Math.sqrt(e)*m})}k()},d.clear=function(){if(!e)return;var a=e.canvas;a.parentNode.removeChild(a)},d}})(docnument,window)