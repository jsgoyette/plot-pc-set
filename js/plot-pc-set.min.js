/* Copyright (c) 2012 Jeremiah Goyette */
function roundNumber(a,b){var c=Math.round(a*Math.pow(10,b))/Math.pow(10,b);return c}var setGraph=function(a){function n(a){var c=Math.cos(a/b.m*2*Math.PI),d=Math.sin(a/b.m*2*Math.PI);return{x:e*d+e+f,y:-1*e*c+e+f}}function o(a){while(a>=b.m)a-=b.m;while(a<0)a+=b.m;return roundNumber(a,2)}function p(a){var b=-1;for(var c=m.length-1;c>=0;c--)m[c].pc==a&&b++;return b<1&&(b=0),(1+b*j)*i}function q(){for(var a=m.length-1;a>=0;a--){if(!m[a].fixed){var b=n(m[a].pc);m[a].dot.attr({cx:b.x,cy:b.y})}m[a].dot.attr({r:p(m[a].pc)})}}var b={};b.m=12;var c,d=!1,e=180,f=30,g=2*(e+f),h=5,i=8,j=.5,k=function(){return!1};b.configure=function(a){e=a.radius||e,f=a.padding||f,g=2*(e+f),h=a.ticksize||h,i=a.dotsize||i,j=a.dotsizeinc||j,k=a.dotclick&&typeof a.dotclick=="function"?a.dotclick:k};var l=function(a,b){this.pc=a||0,this.fixed=b||!1;var d=n(a);this.dot=c.circle(d.x,d.y,p(a)),this.dot.attr({fill:"black"}),this.dot.click(k)},m=[];return b.plotpcs=function(d,i){c&&(b.clear(c),m=[]),c=new Raphael(document.getElementById(a),g,g);var j=c.circle(e+f,e+f,e);j.attr({"stroke-width":4});for(var k=0;k<b.m;k++){var o=n(k),p=c.circle(o.x,o.y,h);p.attr({fill:"white"})}if(d)for(var k=d.length-1;k>=0;k--){i=i||0;var s=k>=i?!1:!0,t=new l(d[k],s);m.unshift(t)}q()},b.getpcs=function(){var a=[];for(var b=m.length-1;b>=0;b--)a.unshift(m[b].pc);return a},b.transpose=function(a,b){for(var c=m.length-1;c>=0;c--)m[c].fixed||(m[c].pc=o(m[c].pc+a));q(),b&&typeof b=="function"&&b()},b.animTranspose=function(a,c){function h(){var b=a*e/f;for(var i=m.length-1;i>=0;i--)m[i].fixed||(m[i].pc=o(g[i]+b));q(),c&&typeof c=="function"&&c(),e<f?setTimeout(function(){h()},10):d=!1,e++}if(d)return;d=!0;var e=0,f=40,g=b.getpcs();h()},b.invert=function(a,b){for(var c=m.length-1;c>=0;c--)m[c].fixed||(m[c].pc=o(a-m[c].pc));q(),b&&typeof b=="function"&&b()},b.animInvert=function(a,c){function h(){var i=e/f;for(var j=m.length-1;j>=0;j--){if(!m[j].fixed){var k=o(a-2*g[j]);k>b.m/2&&(k-=b.m),m[j].pc=o(g[j]+i*k);var l=n(m[j].pc);m[j].dot.attr({cx:l.x,cy:l.y})}m[j].dot.attr({r:p(m[j].pc)})}c&&typeof c=="function"&&c(),e<f?setTimeout(function(){h()},10):d=!1,e++}if(d)return;d=!0;var e=0,f=40,g=b.getpcs();h()},b.animInvertDirect=function(a,b){function q(){var h=c/e;for(var i=m.length-1;i>=0;i--)if(!m[i].fixed){var j=f[i].x+h*(g[i].x-f[i].x),k=f[i].y+h*(g[i].y-f[i].y);m[i].dot.attr({cx:j,cy:k})}if(c<e)setTimeout(function(){q()},10);else{for(var i=m.length-1;i>=0;i--)m[i].fixed||(m[i].pc=o(a-m[i].pc));for(var i=m.length-1;i>=0;i--)m[i].dot.attr({r:p(m[i].pc)});b&&typeof b=="function"&&b(),d=!1}c++}if(d)return;d=!0;var c=0,e=40,f=[],g=[];for(var h=m.length-1;h>=0;h--){m[h].fixed?(f.unshift(0),g.unshift(0)):(f.unshift(n(m[h].pc)),g.unshift(n(o(a-m[h].pc))));var k=0;for(var l=m.length-1;l>=0;l--)h!=l&&m[h].pc==m[l].pc&&m[h].fixed==m[l].fixed&&k++;m[h].dot.attr({r:(1+k*j)*i})}q()},b.clear=function(){if(!c)return;var a=c.canvas;a.parentNode.removeChild(a)},b}