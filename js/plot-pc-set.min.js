/*
 * plot-pc-set.js ~ Copyright (c) 2012 Jeremiah Goyette
 */
(function(a,b){function c(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)}"use strict";var d=b.setGraph=function(d){function r(a){while(a>=i)a-=i;while(a<0)a+=i;return c(a,2)}function s(a){var b=Math.cos(a/i*2*Math.PI),c=Math.sin(a/i*2*Math.PI);return{x:Math.floor(j*c+j+k),y:Math.floor(-1*j*b+j+k)}}function t(){var a,b,c,d=new Array(h.length);for(a=h.length-1;a>=0;a--){c=0;for(b=h.length-1;b>=0;b--){if(b>a&&h[a].pc==h[b].pc){d[a]=d[b];break}h[a].pc==h[b].pc&&c++}d[a]=d[a]||Math.sqrt(c)*n}return d}function u(){var a,b=t();for(a=h.length-1;a>=0;a--){var c=s(h[a].pc);h[a].dot.attr({cx:c.x,cy:c.y}),h[a].dot.attr({r:b[a]})}}var e={},f=null,g=!1,h=[],i=12,j=180,k=30,l=2*(j+k),m=5,n=8,o=50,p=15,q=function(){return!1},v=function(a,b){a=a||0,b=b||!1;var c=s(a),d=f.circle(c.x,c.y,n);return d.attr({fill:"black"}),d.click(q),{pc:a,fixed:b,dot:d}};return e.configure=function(a){i=a.mod||i,j=a.radius||j,k=a.padding||k,l=2*(j+k),m=a.ticksize||m,n=a.dotsize||n,q=a.dotclick&&typeof a.dotclick=="function"?a.dotclick:q},e.plotpcs=function(b,c){f&&(e.clear(f),h=[]),b=b||[],c=c||0,f=new Raphael(a.getElementById(d),l,l);var g,n=f.circle(j+k,j+k,j);n.attr({"stroke-width":4});for(g=0;g<i;g++){var o=s(g),p=f.circle(o.x,o.y,m);p.attr({fill:"white"})}for(g=b.length-1;g>=0;g--){var q=g>=c?!1:!0,r=v(b[g],q);h.unshift(r)}u()},e.getpcs=function(){var a,b=[];for(a=h.length-1;a>=0;a--)b.unshift(h[a].pc);return b},e.transpose=function(a,b){for(var c=h.length-1;c>=0;c--)h[c].fixed||(h[c].pc=r(h[c].pc+a));u(),b&&typeof b=="function"&&b()},e.animTranspose=function(a,c,d){if(g)return;g=!0;var f,i,j=0,k=e.getpcs();(function l(){i=a*j/o;for(f=h.length-1;f>=0;f--)h[f].fixed||(h[f].pc=r(k[f]+i));u(),c&&typeof c=="function"&&c(),j<o?b.setTimeout(function(){l()},p):(g=!1,d&&typeof d=="function"&&d()),j++})()},e.invert=function(a,b){for(var c=h.length-1;c>=0;c--)h[c].fixed||(h[c].pc=r(a-h[c].pc));u(),b&&typeof b=="function"&&b()},e.animInvert=function(a,c,d){if(g)return;g=!0;var f=0,j=e.getpcs();(function k(){var e,l,m,n,q=f/o;for(e=h.length-1;e>=0;e--)h[e].fixed||(n=r(a-2*j[e]),n>i/2&&(n-=i),h[e].pc=r(j[e]+q*n),l=s(h[e].pc),h[e].dot.attr({cx:l.x,cy:l.y}));m=t();for(e=h.length-1;e>=0;e--)h[e].dot.attr({r:m[e]});c&&typeof c=="function"&&c(),f<o?b.setTimeout(function(){k()},p):(g=!1,d&&typeof d=="function"&&d()),f++})()},e.animDirect=function(a,c,d){if(g)return;g=!0;var e,f,i,j,k=0,l=[],m=[];for(e=h.length-1;e>=0;e--){i=0,h[e].fixed?(l.unshift(0),m.unshift(0)):(l.unshift(s(h[e].pc)),a=="invert"?m.unshift(s(r(c-h[e].pc))):m.unshift(s(r(c+h[e].pc))));for(f=h.length-1;f>=0;f--)h[e].pc==h[f].pc&&(h[e].fixed==h[f].fixed||h[e].fixed==0&&h[e].pc==r(c-h[e].pc)||h[f].fixed==0&&h[f].pc==r(c-h[f].pc))&&i++;h[e].dot.attr({r:Math.sqrt(i)*n})}(function q(){var e,f,i,j=k/o;for(e=h.length-1;e>=0;e--)h[e].fixed||(f=l[e].x+j*(m[e].x-l[e].x),i=l[e].y+j*(m[e].y-l[e].y),h[e].dot.attr({cx:f,cy:i}));if(k<o)b.setTimeout(function(){q()},p);else{var n;for(e=h.length-1;e>=0;e--)h[e].fixed||(a=="invert"?f=r(c-h[e].pc):f=r(c+h[e].pc),h[e].pc=f);n=t();for(e=h.length-1;e>=0;e--)h[e].dot.attr({r:n[e]});d&&typeof d=="function"&&d(),g=!1}k++})()},e.clear=function(){if(!f)return;var a=f.canvas;a.parentNode.removeChild(a)},e}})(document,window)